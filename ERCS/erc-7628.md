---
eip: 7628
title: ERC-721 Ownership Shares Extension
description: Introduces ownership shares to ERC-721 tokens, allowing for queryable, transferable, and approvable fractional ownership.
author: Chen Liaoyuan (@chenly) <cly@kip.pro>
discussions-to: https://ethereum-magicians.org/t/erc-7628-erc-721-ownership-shares-extension/18744
status: Draft
type: Standards Track
category: ERC
created: 2024-02-20
requires: 721
---

## Abstract

By introducing ownership shares attributes to [ERC-721](./eip-721.md) tokens, this extension enables precise representation and management of ownership stakes in unique digital assets, bridging the functionality gap between [ERC-721](./eip-721.md), [ERC-1155](./eip-1155.md), and [ERC-20](./eip-20.md) standards.

## Motivation

The proposal aims to strike a balance between [ERC-721](./eip-721.md), [ERC-20](./eip-20.md), and [ERC-1155](./eip-1155.md). While [ERC-20](./eip-20.md) and [ERC-1155](./eip-1155.md) allow representation of the share of an asset held by an address, they lack uniqueness in tokens. Meanwhile, [ERC-721](./eip-721.md) offers uniqueness for each token but lacks attributes to represent the share of an asset.

## Specification

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 and RFC 8174.

Implementers of this extension **MUST** have all of the following functions:

```solidity
pragma solidity ^0.8.0;

interface IERC7628 /* is IERC721 */ {
    /// @notice Returns the number of decimal places used for ownership shares.
    /// @return The number of decimal places for ownership shares.
    function shareDecimals() external view returns (uint8);

    /// @notice Returns the total sum of ownership shares in existence for all tokens.
    /// @return The total sum of ownership shares.
    function totalShares() external view returns (uint256);

    /// @notice Returns the ownership share of the specified token.
    /// @param tokenId The identifier of the token.
    /// @return The ownership share of the token.
    function shareOf(uint256 tokenId) external view returns (uint256);

    /// @notice Returns the share allowance granted to the specified spender by the owner for the specified token.
    /// @param tokenId The identifier of the token.
    /// @param spender The address of the spender.
    /// @return The share allowance granted to the spender.
    function shareAllowance(uint256 tokenId, address spender) external view returns (uint256);

    /// @notice Approves the specified address to spend a specified amount of shares on behalf of the caller.
    /// @param tokenId The identifier of the token.
    /// @param spender The address of the spender.
    /// @param shares The amount of shares to approve.
    function approveShare(uint256 tokenId, address spender, uint256 shares) external;

    /// @notice Transfers ownership shares from one token to another.
    /// @param fromTokenId The identifier of the sender token.
    /// @param toTokenId The identifier of the recipient token.
    /// @param shares The amount of shares to transfer.
    function transferShares(uint256 fromTokenId, uint256 toTokenId, uint256 shares) external;

    /// @notice Transfers ownership shares from one token to another address (resulting in a new token or increased shares at the recipient address).
    /// @param fromTokenId The identifier of the sender token.
    /// @param to The address of the recipient.
    /// @param shares The amount of shares to transfer.
    function transferSharesToAddress(uint256 fromTokenId, address to, uint256 shares) external; 

    /// @notice Adds a specified amount of shares to a token, only callable by the contract owner.
    /// @param tokenId The identifier of the token.
    /// @param shares The amount of shares to add.
    function addSharesToToken(uint256 tokenId, uint256 shares) external;

    /// @notice Emitted when shares are added to a token.
    /// @param tokenId The identifier of the token.
    /// @param shares The amount of shares added.
    event SharesAdded(uint256 indexed tokenId, uint256 shares);

    /// @notice Emitted when ownership shares are transferred from one token to another.
    /// @param fromTokenId The identifier of the sender token.
    /// @param toTokenId The identifier of the recipient token.
    /// @param amount The amount of shares transferred.
    event SharesTransfered(uint256 indexed fromTokenId, uint256 indexed toTokenId, uint256 amount);

    /// @notice Emitted when an approval is granted for a spender to spend shares on behalf of an owner.
    /// @param tokenId The token identifier.
    /// @param spender The address of the spender.
    /// @param amount The amount of shares approved.
    event SharesApproved(uint256 indexed tokenId, address indexed spender, uint256 amount);
}
```

## Rationale

#### Share Issuance to a Token

Issuing additional shares to a token allows for flexible management of ownership stakes in digital assets, catering to the evolving needs of stakeholders. It ensures transparency and security in modifying ownership structures directly on the blockchain, facilitating scenarios like profit sharing or investment adjustments.

#### Transferring Shares to an Address

Enabling shares to be transferred to an address enhances NFT liquidity and accessibility by allowing fractional ownership. This feature supports diverse use cases like fractional sales or collateralization, making NFTs more adaptable and inclusive for a broader audience.

## Backwards Compatibility

This standard is fully [ERC-721](./eip-721.md) compatible.

## Reference Implementation

A full interface of a smart account can be found in [`ERC7628.sol`](../assets/eip-7628/ERC7628.sol).

## Security Considerations

#### Clearing Approvals upon Ownership Transfer
It is crucial to clear any existing approvals when the ownership of a token is transferred. This measure prevents previously approved addresses from retaining access to the tokens once their ownership has changed. Additionally, implementations should ensure that ownership shares are transferred along with the token ownership, maintaining consistency in ownership and access control.

#### Guarding Against Reentrancy Attacks
Implementations must protect against reentrancy attacks, especially in functions that modify balances or ownership, such as `transferShares`. Employing reentrancy guards can help prevent attackers from exploiting vulnerabilities during the execution process. It is important to extend this protection to the transfer of ownership shares, ensuring that reentrancy vulnerabilities are mitigated across all operations involving ownership share manipulation.

#### Validating Token IDs and Addresses
Ensuring the validity of token IDs and addresses in all transfer or approval operations is essential. This includes verifying that token IDs are legitimate and that addresses are not zero, thereby preventing accidental loss or incorrect handling of tokens. Similarly, when transferring ownership shares, validating the token IDs and addresses involved helps maintain the integrity of the ownership share system and prevents potential errors or vulnerabilities.

#### Transferring Balances with Ownership
When the ownership of a token is transferred, it is important to also transfer any associated balances to the new owner. This approach ensures that the ownership and any financial value or rights linked to the token remain consistently aligned. Similarly, when transferring ownership shares, the associated balances should be transferred accordingly, ensuring that the new owner receives the full entitlement associated with the ownership shares.

## Copyright

Copyright and related rights waived via [CC0](../LICENSE.md).
