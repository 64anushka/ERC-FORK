---
eip: 7620
title: Pre-Authorized Service Payment Protocol
description: A protocol for automated, pre-approved ERC-20 deductions by authorized providers.
author: Chen Liaoyuan (@bizliaoyuan) <bizliaoyuan@gmail.com>
discussions-to: https://ethereum-magicians.org/t/eip-7620-pre-authorized-service-payment-protocol/18586
status: Draft
type: Standards Track
category: ERC
created: 2024-02-10
requires: 20
---

## Abstract

This EIP proposes a decentralized mechanism enabling users to pre-authorize specific service providers to deduct funds from their accounts without requiring explicit approval for each transaction. It aims to enhance transaction efficiency and user experience in DApps and services by defining a smart contract interface that safely enables users to pre-authorize [ERC-20](./eip-20.md) token transfers to registered service providers. By utilizing this protocol, a decentralized registry of service providers can be established, where providers can register and deregister themselves, and users can dynamically grant and revoke authorizations based on trust.

## Motivation

In the current Ethereum ecosystem, users encounter the inconvenience of needing to manually confirm each transaction when transferring funds to third parties. This becomes particularly cumbersome for services necessitating frequent micro-payments. Additionally, in certain DApps, there's a desire to obtain user fund authorizations without relying on ERC-20's `approve` method. This reluctance stems from the fact that `approve` does not involve placing funds in a trusted third-party entity.

To address this concern, there's a proposal to introduce a third-party contract capable of receiving and managing authorized funds. These third-party entities could include reputable organizations, such as charities or authoritative institutions. By channeling authorized funds into a dedicated pool, these entities could generate charitable returns or facilitate community benefits.

Furthermore, there's potential to implement governance mechanisms, such as DAO governance or transparent public oversight, for managing the list of authorized service providers. This would enhance trust and transparency, allowing users to dynamically manage their authorizations while ensuring the integrity of the service provider ecosystem. Through these enhancements, the proposed Pre-Authorized Service Payment Protocol not only streamlines transaction processes but also fosters trust, transparency, and community engagement within the Ethereum ecosystem.

## Specification

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 and RFC 8174.

Compliant contracts MUST implement the following interface:

```solidity
pragma solidity ^0.8.20;

interface IERC7620 {
    // Events
    event ServiceProviderRegistered(address serviceProvider); // Event emitted when a service provider is registered
    event ServiceProviderDeregistered(address serviceProvider); // Event emitted when a service provider is deregistered
    event AuthorizationUpdated(address indexed user, address indexed serviceProvider, uint256 newAuthorizedAmount); // Event emitted when authorization amount is updated
    event FundsDeducted(address indexed user, address indexed serviceProvider, uint256 amount, string referenceId); // Event emitted when funds are deducted
    event Deposited(address indexed user, uint256 amount); // Event emitted when funds are deposited
    event AuthorizationRevoked(address indexed user, address indexed serviceProvider); // Event emitted when authorization is revoked
    event Withdrawal(address indexed user, uint256 amount); // Event emitted when funds are withdrawn

    // External functions
    function registerServiceProvider(address serviceProvider) external; // Registers a new service provider
    function deregisterServiceProvider(address serviceProvider) external; // Deregisters a service provider
    function authorizeServiceProvider(address serviceProvider, uint256 amount) external; // Allows users to authorize a service provider to deduct funds
    function revokeAuthorization(address serviceProvider) external; // Revokes authorization for a service provider to deduct funds
    function deductAuthorizedFunds(address user, uint256 amount, string calldata referenceId) external; // Deducts funds from the user's pre-authorized amount
    function deposit(uint256 amount) external; // Allows users to deposit funds into the contract
    function withdraw(uint256 amount) external; // Allows users to withdraw remaining balance

    // View functions
    function authorizedAmount(address user, address serviceProvider) external view returns (uint256); // Returns the authorized amount for a user and service provider
    function isServiceProviderRegistered(address serviceProvider) external view returns (bool); // Checks if a service provider is registered
    function remainingBalance(address user) external view returns (uint256); // Returns the remaining balance for a user
}
```

## Rationale

The Pre-Authorized Service Payment Protocol is designed to enhance the efficiency and security of transactions between users and service providers on the Ethereum blockchain. It reduces the need for repeated transaction approvals, streamlining the payment process for services that require frequent or recurring payments.

## Reference Implementation

See [`ERC7620.sol`](../assets/eip-7620/contracts/ERC7620.sol).

## Security Considerations

The protocol includes several security measures to ensure the safety of user funds and the integrity of service provider transactions. These measures include checks for service provider registration, user authorization levels, and transaction limits. Implementations of this protocol must rigorously enforce these security checks to prevent unauthorized fund deductions and protect against potential abuses.

## Copyright

Copyright and related rights waived via [CC0](../LICENSE.md).